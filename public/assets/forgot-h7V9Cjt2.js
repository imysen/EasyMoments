import{r as s,j as e,C as v,c as N,d as T,e as w,I as C,B as k,h as E,m as K}from"./api-Djm3PB4m.js";import{u as L,T as O}from"./use-config-DCEOYtYw.js";import{L as P}from"./label-DIN_m3m4.js";function R(){const{config:o}=L(),l=!!o?.turnstile_enabled,p=o?.turnstile_site_key||"",[d,c]=s.useState(""),[u,r]=s.useState(""),[y,m]=s.useState(0),[x,h]=s.useState(!1),[f,a]=s.useState(""),[g,j]=s.useState("");async function b(n){if(n.preventDefault(),a(""),j(""),l&&!u)return a("请完成验证码验证");h(!0);try{const t=await fetch("/api/auth/forgot-password",{method:"POST",headers:E("POST"),body:JSON.stringify({email:d,"cf-turnstile-response":u})}),S=await t.json();if(!t.ok)throw r(""),m(i=>i+1),new Error(S?.error||"发送失败");j("如果账号存在，重置邮件已发送。"),c(""),r(""),m(i=>i+1)}catch(t){a(String(t?.message||t))}finally{h(!1)}}return e.jsx("div",{className:"min-h-dvh bg-muted/20",children:e.jsx("main",{className:"mx-auto flex max-w-5xl justify-center px-4 py-10",children:e.jsxs(v,{className:"w-full max-w-md",children:[e.jsx(N,{children:e.jsx(T,{children:"忘记密码"})}),e.jsx(w,{children:e.jsxs("form",{className:"space-y-4",onSubmit:b,children:[f?e.jsx("div",{className:"rounded-md border border-destructive/50 bg-destructive/5 p-3 text-sm text-destructive",children:f}):null,g?e.jsx("div",{className:"rounded-md border bg-muted/40 p-3 text-sm",children:g}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(P,{htmlFor:"forgot-email",children:"邮箱"}),e.jsx(C,{id:"forgot-email",type:"email",autoComplete:"email",value:d,onChange:n=>c(n.target.value),required:!0})]}),e.jsx(O,{enabled:l,siteKey:p,onToken:r,resetKey:y}),e.jsx(k,{className:"w-full",type:"submit",disabled:x,children:x?"发送中...":"发送重置链接"}),e.jsx("div",{className:"text-sm",children:e.jsx("a",{className:"text-muted-foreground hover:underline",href:"/login",children:"返回登录"})})]})})]})})})}K("root",e.jsx(R,{}));
