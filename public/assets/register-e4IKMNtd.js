import{r as s,j as e,C as E,c as K,d as L,e as P,I as l,B as R,h as q,m as F}from"./api-Djm3PB4m.js";import{u as O,T as _}from"./use-config-DCEOYtYw.js";import{L as d}from"./label-DIN_m3m4.js";function B(){const{config:o}=O(),[u,c]=s.useState(""),[m,x]=s.useState(""),[h,g]=s.useState(""),[p,a]=s.useState(""),[N,j]=s.useState(0),[f,y]=s.useState(!1),[v,n]=s.useState(""),[w,S]=s.useState(""),b=!!o?.turnstile_enabled,C=o?.turnstile_site_key||"";async function T(t){if(t.preventDefault(),n(""),S(""),b&&!p){n("请完成验证码验证");return}y(!0);try{const r=await fetch("/api/register",{method:"POST",headers:q("POST"),body:JSON.stringify({email:u,username:m,password:h,"cf-turnstile-response":p})}),k=await r.json();if(!r.ok)throw a(""),j(i=>i+1),new Error(k?.error||"注册失败");S("注册成功！请前往邮箱完成验证后再登录。"),c(""),x(""),g(""),a(""),j(i=>i+1)}catch(r){n(String(r?.message||r))}finally{y(!1)}}return e.jsx("div",{className:"min-h-dvh bg-muted/20",children:e.jsx("main",{className:"mx-auto flex max-w-5xl justify-center px-4 py-10",children:e.jsxs(E,{className:"w-full max-w-md",children:[e.jsx(K,{children:e.jsx(L,{children:"注册"})}),e.jsx(P,{children:e.jsxs("form",{className:"space-y-4",onSubmit:T,children:[v?e.jsx("div",{className:"rounded-md border border-destructive/50 bg-destructive/5 p-3 text-sm text-destructive",children:v}):null,w?e.jsx("div",{className:"rounded-md border bg-muted/40 p-3 text-sm",children:w}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"register-username",children:"用户名 (最多 20 字符)"}),e.jsx(l,{id:"register-username",name:"username",type:"text",maxLength:20,value:m,onChange:t=>x(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"register-email",children:"邮箱"}),e.jsx(l,{id:"register-email",name:"email",type:"email",autoComplete:"email",value:u,onChange:t=>c(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"register-password",children:"密码 (8-16 字符)"}),e.jsx(l,{id:"register-password",name:"password",type:"password",autoComplete:"new-password",value:h,onChange:t=>g(t.target.value),required:!0})]}),e.jsx(_,{enabled:b,siteKey:C,onToken:a,resetKey:N}),e.jsx(R,{className:"w-full",type:"submit",disabled:f,children:f?"处理中...":"注册"}),e.jsx("div",{className:"text-sm",children:e.jsx("a",{className:"text-muted-foreground hover:underline",href:"/login",children:"已有账号？登录"})})]})})]})})})}F("root",e.jsx(B,{}));
